"use strict";(self.webpackChunkmy_ecommerce_frontend=self.webpackChunkmy_ecommerce_frontend||[]).push([[972],{2972(e,r,t){t.r(r),t.d(r,{default:()=>z});var s=t(9379),a=t(5043),o=t(3216),i=t(2720),n=t(3969),l=t(5895),c=t(3089),d=t(6154),u=t(256),x=t(9067),h=t(183),p=t(7471),g=t(3699),m=t(4527),A=t(1725),b=t(8865),j=t(2097),v=t(1244),f=t(8578),y=t(6128),w=t(3759),S=t(172),B=t(4799),P=t(8065),C=t(2579),I=t(3407),k=t(9693),F=t(9147),R=t(916),W=t(6803),N=t(8315),_=t(3201),E=t(1697),D=t(6245),O=t(102),M=t(2672),U=t(2363),q=t(579);function z(){const{id:e}=(0,o.g)(),r=(0,o.Zp)(),t=!!e,[z,H]=(0,a.useState)(!1),[K,J]=(0,a.useState)(!1),[L,T]=(0,a.useState)({open:!1,message:"",severity:"success"}),[Q,Z]=(0,a.useState)(0),[G,V]=(0,a.useState)(""),[X,Y]=(0,a.useState)(""),[$,ee]=(0,a.useState)(""),[re,te]=(0,a.useState)(""),[se,ae]=(0,a.useState)("0"),[oe,ie]=(0,a.useState)(null),[ne,le]=(0,a.useState)(""),[ce,de]=(0,a.useState)(""),[ue,xe]=(0,a.useState)(""),[he,pe]=(0,a.useState)(!0),[ge,me]=(0,a.useState)(!1),Ae=[{value:"tshirts",label:"T-Shirts"},{value:"hoodies",label:"Hoodies"},{value:"jackets",label:"Jackets"},{value:"shirts",label:"Shirts"},{value:"sweatshirts",label:"Sweatshirts"},{value:"pants",label:"Pants"},{value:"cargos",label:"Cargos"},{value:"shorts",label:"Shorts"},{value:"caps",label:"Caps"},{value:"bags",label:"Bags"},{value:"jewelry",label:"Jewelry"},{value:"other",label:"Other"}],be=["Basic Info","Pricing & Stock","Image","Review"];(0,a.useEffect)(()=>{t&&je()},[e]);const je=async()=>{H(!0);try{const{data:s,error:a}=await i.N.from("products").select("*").eq("id",e).single();if(a)throw a;var r,t;if(s)V(s.name||""),Y(s.description||""),ee((null===(r=s.price)||void 0===r?void 0:r.toString())||""),te(s.category||""),ae((null===(t=s.stock)||void 0===t?void 0:t.toString())||"0"),le(s.image_url||""),de(s.brand||""),xe(s.sku||""),s.hasOwnProperty("is_active")&&pe(!1!==s.is_active),s.hasOwnProperty("is_featured")&&me(s.is_featured||!1)}catch(s){console.error("Error fetching product:",s),fe("Error loading product","error")}finally{H(!1)}},ve=e=>{const r=e.target.files[0];if(r){if(!r.type.startsWith("image/"))return void fe("Please select an image file","error");if(r.size>5242880)return void fe("Image size should be less than 5MB","error");ie(r);const e=new FileReader;e.onloadend=()=>le(e.result),e.readAsDataURL(r)}},fe=function(e){T({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};return z&&t?(0,q.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#F5F1E8"},children:(0,q.jsx)(S.A,{sx:{color:"#8B7355"}})}):(0,q.jsxs)(n.A,{sx:{p:3,background:"#F5F1E8",minHeight:"100vh"},children:[(0,q.jsxs)(B.A,{sx:{p:3,borderRadius:"20px",maxWidth:1200,margin:"0 auto",border:"1px solid rgba(139, 115, 85, 0.2)",boxShadow:"0 8px 32px rgba(0,0,0,0.05)"},children:[(0,q.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:4},children:[(0,q.jsx)(P.A,{title:"Back to Dashboard",children:(0,q.jsx)(C.A,{onClick:()=>r("/admin"),sx:{mr:2,color:"#8B7355",background:"rgba(139, 115, 85, 0.1)","&:hover":{background:"rgba(139, 115, 85, 0.2)"}},children:(0,q.jsx)(N.A,{})})}),(0,q.jsx)(n.A,{children:(0,q.jsx)(l.A,{variant:"h4",sx:{fontWeight:800,color:"#4A4A3A"},children:t?"\u270f\ufe0f Edit Product":"\ud83d\ude80 Add New Product"})})]}),(0,q.jsx)(I.A,{activeStep:Q,sx:{mb:4,"& .MuiStepLabel-root .Mui-active":{color:"#8B7355"}},children:be.map(e=>(0,q.jsx)(k.A,{children:(0,q.jsx)(F.A,{children:e})},e))}),(0,q.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),H(!0);try{let a=ne;if(oe)try{a=await(async e=>{try{J(!0);const r=e.name.split(".").pop(),t="".concat(Math.random().toString(36).substring(2),"_").concat(Date.now(),".").concat(r),s="products/".concat(t),{error:a}=await i.N.storage.from("product-images").upload(s,e,{cacheControl:"3600",upsert:!1});if(a)throw a;const{data:{publicUrl:o}}=i.N.storage.from("product-images").getPublicUrl(s);return o}catch(r){throw console.error("Upload error:",r),r}finally{J(!1)}})(oe)}catch(o){console.error("Image upload failed:",o),ne||(a="https://via.placeholder.com/400x300?text=Product+Image")}const n={name:G.trim(),description:X.trim(),price:parseFloat($),category:re,stock:parseInt(se)||0,image_url:a,brand:ce.trim()||null,sku:ue.trim()||"SKU-".concat(Date.now()),updated_at:(new Date).toISOString()},l=(0,s.A)((0,s.A)({},n),{},{is_active:he,is_featured:ge});let c,d=1;try{t?c=await i.N.from("products").update(l).eq("id",e):(l.created_at=(new Date).toISOString(),c=await i.N.from("products").insert([l]));const{error:r}=c;if(r){if(!r.message.includes("is_active")&&!r.message.includes("is_featured"))throw r;{console.log("New columns not found in schema, trying without them..."),d=2,t?c=await i.N.from("products").update(n).eq("id",e):(n.created_at=(new Date).toISOString(),c=await i.N.from("products").insert([n]));const{error:r}=c;if(r)throw r;fe("Product ".concat(t?"updated":"created"," successfully!"),"warning")}}else fe("Product ".concat(t?"updated":"created"," successfully!"),"success")}catch(o){throw console.error("Save attempt ".concat(d," failed:"),o),o}setTimeout(()=>r("/admin"),1500)}catch(o){console.error("Error in form submission:",o),fe("Failed to ".concat(t?"update":"create"," product: ").concat(o.message),"error")}finally{H(!1)}},children:[(e=>{var r;switch(e){case 0:return(0,q.jsxs)(n.A,{sx:{p:3},children:[(0,q.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#8B7355",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(O.A,{}),"Basic Information"]}),(0,q.jsxs)(c.A,{container:!0,spacing:3,children:[(0,q.jsx)(c.A,{item:!0,xs:12,children:(0,q.jsx)(d.A,{label:"Product Name *",value:G,onChange:e=>V(e.target.value),fullWidth:!0,required:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}},placeholder:"Enter product name"})}),(0,q.jsx)(c.A,{item:!0,xs:12,children:(0,q.jsx)(d.A,{label:"Description",value:X,onChange:e=>Y(e.target.value),fullWidth:!0,multiline:!0,rows:4,sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}},placeholder:"Enter product description"})}),(0,q.jsx)(c.A,{item:!0,xs:12,md:6,children:(0,q.jsxs)(u.A,{fullWidth:!0,required:!0,sx:{mb:2},children:[(0,q.jsx)(x.A,{children:"Category *"}),(0,q.jsxs)(h.A,{value:re,onChange:e=>te(e.target.value),label:"Category *",sx:{borderRadius:"12px"},children:[(0,q.jsx)(p.A,{value:"",children:(0,q.jsx)("em",{children:"Select a category"})}),Ae.map(e=>(0,q.jsx)(p.A,{value:e.value,children:e.label},e.value))]})]})}),(0,q.jsx)(c.A,{item:!0,xs:12,md:6,children:(0,q.jsx)(d.A,{label:"Brand",value:ce,onChange:e=>de(e.target.value),fullWidth:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}},placeholder:"Enter brand name"})})]})]});case 1:return(0,q.jsxs)(n.A,{sx:{p:3},children:[(0,q.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#8B7355",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(D.A,{}),"Pricing & Inventory"]}),(0,q.jsxs)(c.A,{container:!0,spacing:3,children:[(0,q.jsx)(c.A,{item:!0,xs:12,md:6,children:(0,q.jsx)(d.A,{label:"Price *",type:"number",value:$,onChange:e=>ee(e.target.value),fullWidth:!0,required:!0,InputProps:{startAdornment:(0,q.jsx)(g.A,{position:"start",children:"\u20b9"}),inputProps:{min:0,step:.01}},sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,q.jsx)(c.A,{item:!0,xs:12,md:6,children:(0,q.jsx)(d.A,{label:"Stock Quantity",type:"number",value:se,onChange:e=>ae(e.target.value),fullWidth:!0,InputProps:{inputProps:{min:0}},sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,q.jsx)(c.A,{item:!0,xs:12,md:6,children:(0,q.jsx)(d.A,{label:"SKU",value:ue,onChange:e=>xe(e.target.value),fullWidth:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:"12px"}},placeholder:"Auto-generated if empty"})}),(0,q.jsxs)(c.A,{item:!0,xs:12,children:[(0,q.jsx)(m.A,{sx:{my:2}}),(0,q.jsx)(l.A,{variant:"subtitle1",sx:{color:"#6B6B5A",mb:2,fontWeight:600},children:"Product Status"}),(0,q.jsxs)(n.A,{sx:{display:"flex",gap:4,flexWrap:"wrap"},children:[(0,q.jsx)(A.A,{control:(0,q.jsx)(b.A,{checked:he,onChange:e=>pe(e.target.checked),color:"primary",sx:{"&.Mui-checked":{color:"#8B7355"}}}),label:(0,q.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(_.A,{sx:{color:he?"#22C55E":"#9CA3AF"}}),(0,q.jsx)(l.A,{children:"Active Product"})]})}),(0,q.jsx)(A.A,{control:(0,q.jsx)(b.A,{checked:ge,onChange:e=>me(e.target.checked),color:"primary",sx:{"&.Mui-checked":{color:"#8B7355"}}}),label:(0,q.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(U.A,{sx:{color:ge?"#FFD700":"#9CA3AF"}}),(0,q.jsx)(l.A,{children:"Featured Product"})]})})]})]})]})]});case 2:return(0,q.jsxs)(n.A,{sx:{p:3},children:[(0,q.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#8B7355",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(E.A,{}),"Product Image"]}),(0,q.jsxs)(n.A,{sx:{textAlign:"center"},children:[(0,q.jsx)("input",{accept:"image/*",style:{display:"none"},id:"image-upload",type:"file",onChange:ve}),(0,q.jsx)("label",{htmlFor:"image-upload",children:(0,q.jsx)(j.A,{variant:"outlined",component:"span",startIcon:(0,q.jsx)(E.A,{}),sx:{mb:3,borderColor:"#8B7355",color:"#8B7355",borderRadius:"12px",px:4,py:1.5,"&:hover":{borderColor:"#755F47",background:"rgba(139, 115, 85, 0.05)"}},children:K?"Uploading...":"Choose Image"})}),ne&&(0,q.jsx)(n.A,{sx:{mt:2},children:(0,q.jsxs)(v.A,{sx:{maxWidth:300,margin:"0 auto",borderRadius:"16px",overflow:"hidden",boxShadow:"0 8px 24px rgba(0,0,0,0.1)"},children:[(0,q.jsx)(f.A,{component:"img",image:ne,alt:"Preview",sx:{height:200,objectFit:"cover"}}),(0,q.jsx)(y.A,{children:oe&&(0,q.jsxs)(l.A,{variant:"caption",sx:{display:"block",color:"text.secondary"},children:[oe.name," (",(oe.size/1024).toFixed(1)," KB)"]})})]})})]})]});case 3:const e=(null===(r=Ae.find(e=>e.value===re))||void 0===r?void 0:r.label)||re||"Not specified";return(0,q.jsxs)(n.A,{sx:{p:3},children:[(0,q.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#8B7355",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(_.A,{}),"Review & Submit"]}),(0,q.jsxs)(c.A,{container:!0,spacing:3,children:[(0,q.jsx)(c.A,{item:!0,xs:12,md:8,children:(0,q.jsx)(v.A,{sx:{mb:3,borderRadius:"16px",border:"1px solid rgba(139, 115, 85, 0.2)",boxShadow:"0 4px 20px rgba(0,0,0,0.05)"},children:(0,q.jsxs)(y.A,{children:[(0,q.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#4A4A3A"},children:"Product Summary"}),(0,q.jsxs)(c.A,{container:!0,spacing:2,children:[(0,q.jsxs)(c.A,{item:!0,xs:6,children:[(0,q.jsx)(l.A,{variant:"body2",sx:{color:"#6B7280",mb:.5},children:"Name:"}),(0,q.jsx)(l.A,{variant:"body1",fontWeight:600,children:G||"Not specified"})]}),(0,q.jsxs)(c.A,{item:!0,xs:6,children:[(0,q.jsx)(l.A,{variant:"body2",sx:{color:"#6B7280",mb:.5},children:"Price:"}),(0,q.jsxs)(l.A,{variant:"body1",fontWeight:600,color:"#8B7355",children:["\u20b9",$||"0.00"]})]}),(0,q.jsxs)(c.A,{item:!0,xs:6,children:[(0,q.jsx)(l.A,{variant:"body2",sx:{color:"#6B7280",mb:.5},children:"Category:"}),(0,q.jsx)(w.A,{label:e,size:"small",sx:{background:"rgba(139, 115, 85, 0.1)",color:"#8B7355",fontWeight:500}})]}),(0,q.jsxs)(c.A,{item:!0,xs:6,children:[(0,q.jsx)(l.A,{variant:"body2",sx:{color:"#6B7280",mb:.5},children:"Stock:"}),(0,q.jsxs)(l.A,{variant:"body1",sx:{fontWeight:600,color:parseInt(se)<10?"#EF4444":"#22C55E"},children:[se," units"]})]})]})]})})}),(0,q.jsx)(c.A,{item:!0,xs:12,md:4,children:(0,q.jsx)(v.A,{sx:{borderRadius:"16px",border:"1px solid rgba(139, 115, 85, 0.2)"},children:(0,q.jsxs)(y.A,{children:[(0,q.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:"#4A4A3A"},children:"Image Preview"}),ne?(0,q.jsx)(f.A,{component:"img",image:ne,alt:"Product",sx:{borderRadius:"12px",mb:2,height:200,objectFit:"cover"}}):(0,q.jsx)(n.A,{sx:{height:200,bgcolor:"#F5F1E8",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"12px"},children:(0,q.jsx)(l.A,{variant:"body2",color:"#8B7355",children:"No image uploaded"})})]})})})]}),(0,q.jsx)(n.A,{sx:{mt:3,p:3,bgcolor:"#F5F1E8",borderRadius:"16px",border:"1px solid rgba(139, 115, 85, 0.2)"},children:(0,q.jsxs)(l.A,{variant:"body2",sx:{color:"#8B7355",mb:1,fontWeight:600},children:["\u26a1 Ready to ",t?"Update":"Publish","!"]})})]});default:return null}})(Q),(0,q.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,q.jsx)(j.A,{disabled:0===Q||z,onClick:()=>{Z(e=>e-1)},sx:{color:"#6B6B5A",fontWeight:600},children:"Back"}),(0,q.jsx)(n.A,{children:Q===be.length-1?(0,q.jsx)(j.A,{type:"submit",variant:"contained",startIcon:(0,q.jsx)(M.A,{}),disabled:z||K,sx:{background:"linear-gradient(135deg, #8B7355 0%, #6B6B5A 100%)",px:5,py:1.5,borderRadius:"12px"},children:z?"Processing...":t?"\u2705 Update Product":"\ud83d\ude80 Create Product"}):(0,q.jsx)(j.A,{variant:"contained",onClick:()=>{(()=>{switch(Q){case 0:return G.trim()?!!re||(fe("Please select a category","error"),!1):(fe("Product name is required","error"),!1);case 1:if(!$)return fe("Price is required","error"),!1;const e=parseFloat($);if(isNaN(e)||e<=0)return fe("Price must be greater than 0","error"),!1;const r=parseInt(se);return!(isNaN(r)||r<0)||(fe("Stock must be 0 or greater","error"),!1);case 2:return!(!ne&&!oe)||(fe("Please upload a product image","error"),!1);default:return!0}})()&&Z(e=>e+1)},sx:{background:"linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%)",px:5,py:1.5,borderRadius:"12px"},children:"Continue"})})]})]})]}),(0,q.jsx)(R.A,{open:L.open,autoHideDuration:4e3,onClose:()=>T((0,s.A)((0,s.A)({},L),{},{open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,q.jsx)(W.A,{onClose:()=>T((0,s.A)((0,s.A)({},L),{},{open:!1})),severity:L.severity,sx:{width:"100%",borderRadius:"12px"},children:L.message})})]})}}}]);
//# sourceMappingURL=972.a6779311.chunk.js.map