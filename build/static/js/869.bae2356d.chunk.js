"use strict";(self.webpackChunkmy_ecommerce_frontend=self.webpackChunkmy_ecommerce_frontend||[]).push([[869],{6869(e,s,r){r.r(s),r.d(s,{default:()=>J});var n=r(9379),i=r(5043),t=r(3216),l=r(2720),a=r(3969),d=r(9806),o=r(2579),c=r(5895),x=r(2097),u=r(3089),h=r(1244),p=r(4799),A=r(6154),g=r(256),j=r(9067),m=r(183),v=r(7471),f=r(8259),b=r(172),C=r(7443),_=r(756),S=r(6172),y=r(1341),W=r(4375),w=r(3759),k=r(3023),R=r(1911),F=r(8776),B=r(7873),E=r(5877),I=r(916),P=r(6803),T=r(8315),O=r(3974),z=r(3201),L=r(4856),D=r(9302),N=r(6691),U=r(3665),q=r(7359),H=r(908),G=r(579);function J(){var e,s,r;const[J,M]=(0,i.useState)([]),[Q,Z]=(0,i.useState)([]),[$,K]=(0,i.useState)(!0),[V,X]=(0,i.useState)(""),[Y,ee]=(0,i.useState)("all"),[se,re]=(0,i.useState)([null,null]),[ne,ie]=(0,i.useState)(!1),[te,le]=(0,i.useState)(null),[ae,de]=(0,i.useState)({open:!1,message:"",severity:"success"}),oe=(0,t.Zp)(),ce={pageWrapper:{background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",minHeight:"100vh",pb:8,pt:4},glassPanel:{background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(20px)",borderRadius:"24px",border:"1px solid rgba(255, 255, 255, 0.9)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.07)",transition:"all 0.4s ease"},gradientText:{background:"linear-gradient(45deg, #111 30%, #555 90%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:900},tableRow:{transition:"all 0.2s ease","&:hover":{background:"rgba(255,255,255,0.9) !important",transform:"scale(1.005)",zIndex:2,position:"relative"}}};(0,i.useEffect)(()=>{xe()},[]),(0,i.useEffect)(()=>{ue()},[J,V,Y,se]);const xe=async()=>{try{const{data:e,error:s}=await l.N.from("orders").select("\n          *,\n          order_items (\n            id,\n            product_name,\n            quantity,\n            price_at_time,\n            image_url\n          ),\n          profiles (\n            email,\n            full_name,\n            phone\n          )\n        ").order("created_at",{ascending:!1});if(s)throw s;M(e||[]),Z(e||[])}catch(e){console.error("Error fetching orders:",e),Ae("Error loading orders","error")}finally{K(!1)}},ue=()=>{let e=J;if(V){const s=V.toLowerCase();e=e.filter(e=>{var r,n,i,t,l,a;return(null===(r=e.order_number)||void 0===r?void 0:r.toLowerCase().includes(s))||(null===(n=e.id)||void 0===n?void 0:n.toLowerCase().includes(s))||(null===(i=e.shipping_address)||void 0===i||null===(t=i.name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(l=e.profiles)||void 0===l||null===(a=l.email)||void 0===a?void 0:a.toLowerCase().includes(s))})}"all"!==Y&&(e=e.filter(e=>e.status===Y)),Z(e)},he={totalRevenue:J.reduce((e,s)=>e+Number(s.total_amount||0),0),pending:J.filter(e=>"pending"===e.status).length,processing:J.filter(e=>"processing"===e.status).length,total:J.length},pe=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pending":return"#F59E0B";case"processing":return"#3B82F6";case"shipped":return"#8B5CF6";case"delivered":return"#10B981";case"cancelled":return"#EF4444";default:return"#6B7280"}},Ae=function(e){return de({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};return(0,G.jsx)(q.$J,{dateAdapter:H.h,children:(0,G.jsx)(a.A,{sx:ce.pageWrapper,children:(0,G.jsxs)(d.A,{maxWidth:"xl",children:[(0,G.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:5},children:[(0,G.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,G.jsx)(o.A,{onClick:()=>oe("/admin"),sx:{bgcolor:"white"},children:(0,G.jsx)(T.A,{})}),(0,G.jsx)(c.A,{variant:"h3",sx:ce.gradientText,children:"Order Command"})]}),(0,G.jsx)(x.A,{variant:"outlined",startIcon:(0,G.jsx)(D.A,{}),onClick:xe,sx:{borderRadius:"30px"},children:"Refresh"})]}),(0,G.jsx)(u.A,{container:!0,spacing:3,sx:{mb:5},children:[{title:"Total Revenue",value:"\u20b9".concat(he.totalRevenue.toLocaleString()),icon:(0,G.jsx)(O.A,{}),color:"#10B981"},{title:"Pending",value:he.pending,icon:(0,G.jsx)(N.A,{}),color:"#F59E0B"},{title:"Processing",value:he.processing,icon:(0,G.jsx)(L.A,{}),color:"#3B82F6"}].map((e,s)=>(0,G.jsx)(u.A,{item:!0,xs:12,md:4,children:(0,G.jsx)(h.A,{sx:(0,n.A)((0,n.A)({},ce.glassPanel),{},{p:2}),children:(0,G.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,G.jsx)(a.A,{sx:{p:1.5,borderRadius:"12px",bgcolor:"".concat(e.color,"20"),color:e.color},children:e.icon}),(0,G.jsxs)(a.A,{children:[(0,G.jsx)(c.A,{variant:"h4",fontWeight:800,children:e.value}),(0,G.jsx)(c.A,{variant:"caption",color:"text.secondary",children:e.title})]})]})})},s))}),(0,G.jsx)(p.A,{sx:(0,n.A)((0,n.A)({},ce.glassPanel),{},{p:3,mb:4}),children:(0,G.jsxs)(u.A,{container:!0,spacing:2,children:[(0,G.jsx)(u.A,{item:!0,xs:12,md:4,children:(0,G.jsx)(A.A,{fullWidth:!0,placeholder:"Search...",value:V,onChange:e=>X(e.target.value),size:"small"})}),(0,G.jsx)(u.A,{item:!0,xs:12,md:3,children:(0,G.jsxs)(g.A,{fullWidth:!0,size:"small",children:[(0,G.jsx)(j.A,{children:"Status"}),(0,G.jsxs)(m.A,{value:Y,onChange:e=>ee(e.target.value),label:"Status",children:[(0,G.jsx)(v.A,{value:"all",children:"All"}),(0,G.jsx)(v.A,{value:"pending",children:"Pending"}),(0,G.jsx)(v.A,{value:"processing",children:"Processing"}),(0,G.jsx)(v.A,{value:"shipped",children:"Shipped"}),(0,G.jsx)(v.A,{value:"delivered",children:"Delivered"})]})]})})]})}),(0,G.jsx)(f.A,{component:p.A,sx:(0,n.A)((0,n.A)({},ce.glassPanel),{},{mb:8}),children:$?(0,G.jsx)(a.A,{sx:{p:5,textAlign:"center"},children:(0,G.jsx)(b.A,{})}):(0,G.jsxs)(C.A,{children:[(0,G.jsx)(_.A,{sx:{bgcolor:"rgba(0,0,0,0.03)"},children:(0,G.jsxs)(S.A,{children:[(0,G.jsx)(y.A,{fontWeight:800,children:"ORDER ID"}),(0,G.jsx)(y.A,{fontWeight:800,children:"CUSTOMER"}),(0,G.jsx)(y.A,{fontWeight:800,children:"TOTAL"}),(0,G.jsx)(y.A,{fontWeight:800,children:"STATUS"}),(0,G.jsx)(y.A,{fontWeight:800,children:"ACTIONS"})]})}),(0,G.jsx)(W.A,{children:Q.map(e=>{var s,r,n,i;return(0,G.jsxs)(S.A,{sx:ce.tableRow,children:[(0,G.jsx)(y.A,{children:(0,G.jsx)(w.A,{label:e.order_number||e.id.slice(0,8).toUpperCase(),sx:{borderRadius:"8px",fontWeight:700}})}),(0,G.jsxs)(y.A,{children:[(0,G.jsx)(c.A,{variant:"subtitle2",fontWeight:700,children:(null===(s=e.shipping_address)||void 0===s?void 0:s.name)||(null===(r=e.profiles)||void 0===r?void 0:r.full_name)||"Guest"}),(0,G.jsx)(c.A,{variant:"caption",children:null===(n=e.profiles)||void 0===n?void 0:n.email})]}),(0,G.jsxs)(y.A,{sx:{fontWeight:800},children:["\u20b9",Number(e.total_amount||0).toFixed(2)]}),(0,G.jsx)(y.A,{children:(0,G.jsx)(w.A,{label:null===(i=e.status)||void 0===i?void 0:i.toUpperCase(),size:"small",sx:{bgcolor:"".concat(pe(e.status),"20"),color:pe(e.status),fontWeight:800}})}),(0,G.jsx)(y.A,{children:(0,G.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,G.jsx)(o.A,{size:"small",onClick:()=>{le(e),ie(!0)},children:(0,G.jsx)(U.A,{fontSize:"small"})}),"pending"===e.status&&(0,G.jsx)(o.A,{size:"small",onClick:()=>(async(e,s)=>{try{const{error:r}=await l.N.from("orders").update({status:s,updated_at:(new Date).toISOString()}).eq("id",e);if(r)throw r;Ae("Order status updated to ".concat(s),"success"),xe()}catch(r){Ae("Error updating status","error")}})(e.id,"processing"),sx:{color:"#3B82F6"},children:(0,G.jsx)(z.A,{fontSize:"small"})})]})})]},e.id)})})]})}),(0,G.jsx)(k.A,{open:ne,onClose:()=>ie(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"24px"}},children:te&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(R.A,{children:["Order #",te.order_number||te.id.slice(0,8)]}),(0,G.jsx)(F.A,{dividers:!0,children:(0,G.jsxs)(u.A,{container:!0,spacing:2,children:[(0,G.jsxs)(u.A,{item:!0,xs:6,children:[(0,G.jsx)(c.A,{variant:"subtitle2",children:"Customer"}),(0,G.jsx)(c.A,{children:null===(e=te.shipping_address)||void 0===e?void 0:e.name})]}),(0,G.jsxs)(u.A,{item:!0,xs:6,children:[(0,G.jsx)(c.A,{variant:"subtitle2",children:"Shipping"}),(0,G.jsx)(c.A,{children:null===(s=te.shipping_address)||void 0===s?void 0:s.address})]}),(0,G.jsxs)(u.A,{item:!0,xs:12,sx:{mt:2},children:[(0,G.jsx)(c.A,{variant:"subtitle2",sx:{mb:1},children:"Items Ordered"}),null===(r=te.order_items)||void 0===r?void 0:r.map((e,s)=>(0,G.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2,mb:1,p:1,border:"1px solid #eee",borderRadius:"8px"},children:[(0,G.jsx)(B.A,{src:e.image_url,variant:"rounded"}),(0,G.jsxs)(a.A,{children:[(0,G.jsx)(c.A,{variant:"body2",fontWeight:600,children:e.product_name}),(0,G.jsxs)(c.A,{variant:"caption",children:["Qty: ",e.quantity," | \u20b9",e.price_at_time]})]})]},s))]})]})}),(0,G.jsx)(E.A,{children:(0,G.jsx)(x.A,{onClick:()=>ie(!1),children:"Close"})})]})}),(0,G.jsx)(I.A,{open:ae.open,autoHideDuration:4e3,onClose:()=>de((0,n.A)((0,n.A)({},ae),{},{open:!1})),children:(0,G.jsx)(P.A,{severity:ae.severity,children:ae.message})})]})})})}}}]);
//# sourceMappingURL=869.bae2356d.chunk.js.map