"use strict";(self.webpackChunkmy_ecommerce_frontend=self.webpackChunkmy_ecommerce_frontend||[]).push([[869],{6869(e,r,s){s.r(r),s.d(r,{default:()=>K});var i=s(9379),n=s(5043),t=s(5685),o=s(2720),l=s(3969),d=s(5895),a=s(2097),c=s(3089),x=s(1244),h=s(6128),u=s(4799),A=s(4343),p=s(256),g=s(3353),j=s(183),v=s(7471),m=s(172),b=s(8259),f=s(7443),C=s(756),_=s(6172),y=s(1341),w=s(4375),B=s(3759),F=s(6529),S=s(2579),k=s(8517),W=s(1911),O=s(8776),D=s(4527),I=s(5877),E=s(916),L=s(6803),R=s(3974),P=s(3201),N=s(7305),z=s(847),M=s(4856),T=s(8231),q=s(160),U=s(9302),G=s(3745),H=s(6691),V=s(3665),J=s(7875),Q=s(4793),Z=s(5984),$=s(579);function K(){var e,r,s,K,Y,ee,re,se,ie,ne,te;const[oe,le]=(0,n.useState)([]),[de,ae]=(0,n.useState)([]),[ce,xe]=(0,n.useState)(!0),[he,ue]=(0,n.useState)(""),[Ae,pe]=(0,n.useState)("all"),[ge,je]=(0,n.useState)([null,null]),[ve,me]=(0,n.useState)(!1),[be,fe]=(0,n.useState)(null),[Ce,_e]=(0,n.useState)({open:!1,message:"",severity:"success"}),ye=(0,t.Zp)();(0,n.useEffect)(()=>{we()},[]),(0,n.useEffect)(()=>{Be()},[oe,he,Ae,ge]);const we=async()=>{try{const{data:e,error:r}=await o.N.from("orders").select("\n          *,\n          order_items (\n            id,\n            quantity,\n            price_at_time,\n            product_id,\n            products (\n              name,\n              image_url\n            )\n          ),\n          users (\n            email,\n            full_name,\n            phone\n          )\n        ").order("created_at",{ascending:!1});if(r)throw r;le(e||[]),ae(e||[])}catch(e){console.error("Error fetching orders:",e),ke("Error loading orders","error")}finally{xe(!1)}},Be=()=>{let e=oe;he&&(e=e.filter(e=>{var r,s,i,n,t,o,l,d;return(null===(r=e.order_number)||void 0===r?void 0:r.toLowerCase().includes(he.toLowerCase()))||(null===(s=e.id)||void 0===s?void 0:s.toLowerCase().includes(he.toLowerCase()))||(null===(i=e.shipping_address)||void 0===i||null===(n=i.name)||void 0===n?void 0:n.toLowerCase().includes(he.toLowerCase()))||(null===(t=e.shipping_address)||void 0===t||null===(o=t.email)||void 0===o?void 0:o.toLowerCase().includes(he.toLowerCase()))||(null===(l=e.users)||void 0===l||null===(d=l.email)||void 0===d?void 0:d.toLowerCase().includes(he.toLowerCase()))})),"all"!==Ae&&(e=e.filter(e=>e.status===Ae)),ge[0]&&ge[1]&&(e=e.filter(e=>{const r=new Date(e.created_at);return r>=ge[0]&&r<=ge[1]})),ae(e)},Fe=async(e,r)=>{try{const{error:s}=await o.N.from("orders").update((0,i.A)((0,i.A)({status:r,updated_at:(new Date).toISOString()},"shipped"===r&&{shipped_at:(new Date).toISOString()}),"delivered"===r&&{delivered_at:(new Date).toISOString()})).eq("id",e);if(s)throw s;ke("Order status updated to ".concat(r),"success"),we()}catch(s){console.error("Error updating order:",s),ke("Error updating order status","error")}},Se=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pending":return"#FF9800";case"processing":return"#2196F3";case"shipped":return"#4CAF50";case"delivered":return"#22C55E";case"cancelled":return"#EF4444";default:return"#6B7280"}},ke=function(e){_e({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})},We={totalRevenue:oe.reduce((e,r)=>e+(r.total_amount||0),0),pendingOrders:oe.filter(e=>"pending"===e.status).length,processingOrders:oe.filter(e=>"processing"===e.status).length,shippedOrders:oe.filter(e=>"shipped"===e.status).length,deliveredOrders:oe.filter(e=>"delivered"===e.status).length,totalOrders:oe.length};return(0,$.jsx)(Q.$J,{dateAdapter:Z.h,children:(0,$.jsxs)(l.A,{sx:{p:3,background:"#F5F1E8",minHeight:"100vh"},children:[(0,$.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,$.jsxs)(l.A,{children:[(0,$.jsx)(d.A,{variant:"h4",sx:{fontWeight:800,color:"#4A4A3A",mb:.5},children:"\ud83d\udce6 Order Management"}),(0,$.jsx)(d.A,{variant:"body1",sx:{color:"#6B6B5A"},children:"Manage and track customer orders"})]}),(0,$.jsxs)(l.A,{sx:{display:"flex",gap:2},children:[(0,$.jsx)(a.A,{variant:"outlined",startIcon:(0,$.jsx)(N.A,{}),sx:{borderColor:"#8B7355",color:"#8B7355",fontWeight:600,"&:hover":{borderColor:"#755F47",background:"rgba(139, 115, 85, 0.05)"}},children:"Export Orders"}),(0,$.jsx)(a.A,{variant:"outlined",startIcon:(0,$.jsx)(U.A,{}),onClick:we,sx:{borderColor:"#3B82F6",color:"#3B82F6",fontWeight:600,"&:hover":{borderColor:"#2563EB",background:"rgba(59, 130, 246, 0.05)"}},children:"Refresh"})]})]}),(0,$.jsx)(c.A,{container:!0,spacing:3,sx:{mb:4},children:[{title:"Total Revenue",value:"\u20b9".concat(We.totalRevenue.toLocaleString("en-IN")),icon:(0,$.jsx)(R.A,{}),color:"#22C55E",subtext:"All orders"},{title:"Total Orders",value:We.totalOrders,icon:(0,$.jsx)(H.A,{}),color:"#8B7355",subtext:"".concat(We.pendingOrders," pending")},{title:"Processing",value:We.processingOrders,icon:(0,$.jsx)(z.A,{}),color:"#2196F3",subtext:"In progress"},{title:"Delivered",value:We.deliveredOrders,icon:(0,$.jsx)(P.A,{}),color:"#22C55E",subtext:"Completed orders"}].map((e,r)=>(0,$.jsx)(c.A,{item:!0,xs:12,sm:6,md:3,children:(0,$.jsx)(x.A,{sx:{borderRadius:3,background:"white",boxShadow:"0 8px 24px rgba(0,0,0,0.05)",border:"1px solid rgba(139, 115, 85, 0.1)",height:"100%"},children:(0,$.jsxs)(h.A,{children:[(0,$.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[(0,$.jsx)(l.A,{sx:{background:"".concat(e.color,"15"),p:1.5,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,$.jsx)(l.A,{sx:{color:e.color,fontSize:28},children:e.icon})}),(0,$.jsxs)(l.A,{children:[(0,$.jsx)(d.A,{variant:"h3",sx:{fontWeight:800,color:"#2A2A2A",mb:.5},children:e.value}),(0,$.jsx)(d.A,{variant:"body2",sx:{color:"#6B6B5A",fontWeight:500},children:e.title})]})]}),(0,$.jsx)(d.A,{variant:"caption",sx:{color:"#8B7355",fontWeight:500},children:e.subtext})]})})},r))}),(0,$.jsx)(u.A,{sx:{p:3,mb:3,borderRadius:3,background:"white",boxShadow:"0 8px 24px rgba(0,0,0,0.05)",border:"1px solid rgba(139, 115, 85, 0.1)"},children:(0,$.jsxs)(c.A,{container:!0,spacing:2,alignItems:"center",children:[(0,$.jsx)(c.A,{item:!0,xs:12,md:4,children:(0,$.jsx)(A.A,{fullWidth:!0,placeholder:"Search orders by ID, name, email...",value:he,onChange:e=>ue(e.target.value),InputProps:{startAdornment:(0,$.jsx)(G.A,{sx:{color:"#8B7355",mr:1}})},sx:X.textField})}),(0,$.jsx)(c.A,{item:!0,xs:12,md:3,children:(0,$.jsxs)(p.A,{fullWidth:!0,sx:X.select,children:[(0,$.jsx)(g.A,{children:"Status"}),(0,$.jsxs)(j.A,{value:Ae,onChange:e=>pe(e.target.value),label:"Status",children:[(0,$.jsx)(v.A,{value:"all",children:"All Status"}),(0,$.jsx)(v.A,{value:"pending",children:"Pending"}),(0,$.jsx)(v.A,{value:"processing",children:"Processing"}),(0,$.jsx)(v.A,{value:"shipped",children:"Shipped"}),(0,$.jsx)(v.A,{value:"delivered",children:"Delivered"}),(0,$.jsx)(v.A,{value:"cancelled",children:"Cancelled"})]})]})}),(0,$.jsx)(c.A,{item:!0,xs:12,md:3,children:(0,$.jsx)(J.l,{label:"From Date",value:ge[0],onChange:e=>je([e,ge[1]]),slotProps:{textField:{fullWidth:!0}}})}),(0,$.jsx)(c.A,{item:!0,xs:12,md:2,children:(0,$.jsx)(a.A,{variant:"contained",fullWidth:!0,startIcon:(0,$.jsx)(z.A,{}),onClick:Be,sx:{background:"#8B7355",color:"white",borderRadius:2,height:"56px","&:hover":{background:"#755F47"}},children:"Filter"})})]})}),(0,$.jsx)(u.A,{sx:{borderRadius:3,background:"white",boxShadow:"0 8px 24px rgba(0,0,0,0.05)",border:"1px solid rgba(139, 115, 85, 0.1)",overflow:"hidden"},children:ce?(0,$.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,$.jsx)(m.A,{sx:{color:"#8B7355"}})}):(0,$.jsx)(b.A,{children:(0,$.jsxs)(f.A,{children:[(0,$.jsx)(C.A,{sx:{background:"#F5F1E8"},children:(0,$.jsxs)(_.A,{children:[(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Order ID"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Customer"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Date"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Items"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Amount"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Status"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Payment"}),(0,$.jsx)(y.A,{sx:{fontWeight:700,color:"#4A4A3A"},children:"Actions"})]})}),(0,$.jsx)(w.A,{children:de.map(e=>{var r,s,i,n,t,o,a,c;return(0,$.jsxs)(_.A,{hover:!0,children:[(0,$.jsx)(y.A,{children:(0,$.jsx)(d.A,{sx:{fontWeight:600,color:"#2A2A2A",fontFamily:"monospace"},children:e.order_number||"ORD-".concat(e.id.slice(-8).toUpperCase())})}),(0,$.jsx)(y.A,{children:(0,$.jsxs)(l.A,{children:[(0,$.jsx)(d.A,{sx:{fontWeight:500,color:"#4A4A3A"},children:(null===(r=e.shipping_address)||void 0===r?void 0:r.name)||(null===(s=e.users)||void 0===s?void 0:s.full_name)||"Customer"}),(0,$.jsx)(d.A,{variant:"body2",sx:{color:"#6B6B5A"},children:(null===(i=e.shipping_address)||void 0===i?void 0:i.email)||(null===(n=e.users)||void 0===n?void 0:n.email)||"No email"})]})}),(0,$.jsxs)(y.A,{children:[(0,$.jsx)(d.A,{sx:{color:"#6B6B5A"},children:new Date(e.created_at).toLocaleDateString()}),(0,$.jsx)(d.A,{variant:"body2",sx:{color:"#8B7355"},children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,$.jsx)(y.A,{children:(0,$.jsxs)(d.A,{sx:{fontWeight:500,color:"#4A4A3A"},children:[(null===(t=e.order_items)||void 0===t?void 0:t.length)||0," items"]})}),(0,$.jsx)(y.A,{children:(0,$.jsxs)(d.A,{sx:{fontWeight:700,color:"#8B7355"},children:["\u20b9",null===(o=e.total_amount)||void 0===o?void 0:o.toFixed(2)]})}),(0,$.jsx)(y.A,{children:(0,$.jsx)(B.A,{label:(null===(a=e.status)||void 0===a?void 0:a.toUpperCase())||"PENDING",size:"small",sx:{background:"".concat(Se(e.status),"15"),color:Se(e.status),fontWeight:600,textTransform:"uppercase"}})}),(0,$.jsx)(y.A,{children:(0,$.jsx)(B.A,{label:(null===(c=e.payment_status)||void 0===c?void 0:c.toUpperCase())||"PENDING",size:"small",sx:{background:"paid"===e.payment_status?"#22C55E15":"#FF980015",color:"paid"===e.payment_status?"#22C55E":"#FF9800",fontWeight:600,textTransform:"uppercase"}})}),(0,$.jsx)(y.A,{children:(0,$.jsxs)(l.A,{sx:{display:"flex",gap:1},children:[(0,$.jsx)(F.A,{title:"View Details",children:(0,$.jsx)(S.A,{size:"small",onClick:()=>(e=>{fe(e),me(!0)})(e),sx:{color:"#8B7355","&:hover":{background:"rgba(139, 115, 85, 0.1)"}},children:(0,$.jsx)(V.A,{fontSize:"small"})})}),"pending"===e.status&&(0,$.jsx)(F.A,{title:"Mark as Processing",children:(0,$.jsx)(S.A,{size:"small",onClick:()=>Fe(e.id,"processing"),sx:{color:"#2196F3","&:hover":{background:"rgba(33, 150, 243, 0.1)"}},children:(0,$.jsx)(P.A,{fontSize:"small"})})}),"processing"===e.status&&(0,$.jsx)(F.A,{title:"Mark as Shipped",children:(0,$.jsx)(S.A,{size:"small",onClick:()=>Fe(e.id,"shipped"),sx:{color:"#4CAF50","&:hover":{background:"rgba(76, 175, 80, 0.1)"}},children:(0,$.jsx)(M.A,{fontSize:"small"})})})]})})]},e.id)})})]})})}),(0,$.jsx)(k.A,{open:ve,onClose:()=>me(!1),maxWidth:"md",fullWidth:!0,children:be&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(W.A,{sx:{background:"#F5F1E8",color:"#4A4A3A",fontWeight:700},children:["Order Details: ",be.order_number||"ORD-".concat(be.id.slice(-8).toUpperCase())]}),(0,$.jsx)(O.A,{dividers:!0,children:(0,$.jsxs)(c.A,{container:!0,spacing:3,children:[(0,$.jsxs)(c.A,{item:!0,xs:12,md:6,children:[(0,$.jsxs)(d.A,{variant:"subtitle1",sx:{color:"#8B7355",fontWeight:600,mb:2},children:[(0,$.jsx)(q.A,{sx:{mr:1,verticalAlign:"middle"}}),"Customer Information"]}),(0,$.jsxs)(l.A,{sx:{pl:3},children:[(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#4A4A3A",mb:1},children:[(0,$.jsx)("strong",{children:"Name:"})," ",(null===(e=be.shipping_address)||void 0===e?void 0:e.name)||(null===(r=be.users)||void 0===r?void 0:r.full_name)||"N/A"]}),(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#4A4A3A",mb:1},children:[(0,$.jsx)("strong",{children:"Email:"})," ",(null===(s=be.shipping_address)||void 0===s?void 0:s.email)||(null===(K=be.users)||void 0===K?void 0:K.email)||"N/A"]}),(null===(Y=be.shipping_address)||void 0===Y?void 0:Y.phone)&&(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#4A4A3A",mb:1},children:[(0,$.jsx)("strong",{children:"Phone:"})," ",be.shipping_address.phone]})]})]}),(0,$.jsxs)(c.A,{item:!0,xs:12,md:6,children:[(0,$.jsxs)(d.A,{variant:"subtitle1",sx:{color:"#8B7355",fontWeight:600,mb:2},children:[(0,$.jsx)(T.A,{sx:{mr:1,verticalAlign:"middle"}}),"Shipping Address"]}),(0,$.jsx)(l.A,{sx:{pl:3},children:(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#4A4A3A"},children:[(null===(ee=be.shipping_address)||void 0===ee?void 0:ee.address)||"N/A",(0,$.jsx)("br",{}),(null===(re=be.shipping_address)||void 0===re?void 0:re.city)&&"".concat(be.shipping_address.city,", "),null===(se=be.shipping_address)||void 0===se?void 0:se.state,(0,$.jsx)("br",{}),(null===(ie=be.shipping_address)||void 0===ie?void 0:ie.pincode)&&"Pincode: ".concat(be.shipping_address.pincode)]})})]}),(0,$.jsxs)(c.A,{item:!0,xs:12,children:[(0,$.jsx)(D.A,{sx:{my:2}}),(0,$.jsxs)(d.A,{variant:"subtitle1",sx:{color:"#8B7355",fontWeight:600,mb:2},children:[(0,$.jsx)(H.A,{sx:{mr:1,verticalAlign:"middle"}}),"Order Items"]}),(0,$.jsx)(b.A,{children:(0,$.jsxs)(f.A,{size:"small",children:[(0,$.jsx)(C.A,{children:(0,$.jsxs)(_.A,{children:[(0,$.jsx)(y.A,{children:"Product"}),(0,$.jsx)(y.A,{align:"right",children:"Price"}),(0,$.jsx)(y.A,{align:"right",children:"Quantity"}),(0,$.jsx)(y.A,{align:"right",children:"Total"})]})}),(0,$.jsx)(w.A,{children:null===(ne=be.order_items)||void 0===ne?void 0:ne.map((e,r)=>{var s,i,n,t;return(0,$.jsxs)(_.A,{children:[(0,$.jsx)(y.A,{children:(0,$.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,$.jsx)(l.A,{component:"img",src:(null===(s=e.products)||void 0===s?void 0:s.image_url)||"https://via.placeholder.com/40",alt:null===(i=e.products)||void 0===i?void 0:i.name,sx:{width:40,height:40,borderRadius:1,objectFit:"cover"}}),(0,$.jsx)(d.A,{variant:"body2",children:(null===(n=e.products)||void 0===n?void 0:n.name)||"Product"})]})}),(0,$.jsxs)(y.A,{align:"right",children:["\u20b9",null===(t=e.price_at_time)||void 0===t?void 0:t.toFixed(2)]}),(0,$.jsx)(y.A,{align:"right",children:e.quantity}),(0,$.jsxs)(y.A,{align:"right",children:["\u20b9",(e.quantity*e.price_at_time).toFixed(2)]})]},r)})})]})})]}),(0,$.jsxs)(c.A,{item:!0,xs:12,children:[(0,$.jsx)(D.A,{sx:{my:2}}),(0,$.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,$.jsxs)(l.A,{children:[(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#6B6B5A"},children:[(0,$.jsx)("strong",{children:"Order Date:"})," ",new Date(be.created_at).toLocaleString()]}),be.shipped_at&&(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#6B6B5A"},children:[(0,$.jsx)("strong",{children:"Shipped Date:"})," ",new Date(be.shipped_at).toLocaleDateString()]}),be.delivered_at&&(0,$.jsxs)(d.A,{variant:"body2",sx:{color:"#6B6B5A"},children:[(0,$.jsx)("strong",{children:"Delivered Date:"})," ",new Date(be.delivered_at).toLocaleDateString()]})]}),(0,$.jsxs)(l.A,{sx:{textAlign:"right"},children:[(0,$.jsxs)(d.A,{variant:"h6",sx:{color:"#8B7355",fontWeight:700},children:["Total: \u20b9",null===(te=be.total_amount)||void 0===te?void 0:te.toFixed(2)]}),(0,$.jsxs)(d.A,{variant:"caption",sx:{color:"#6B6B5A"},children:[be.payment_method," \u2022 ",be.payment_status]})]})]})]})]})}),(0,$.jsxs)(I.A,{sx:{p:3,background:"#F5F1E8"},children:[(0,$.jsx)(a.A,{onClick:()=>me(!1),sx:{color:"#6B6B5A"},children:"Close"}),(0,$.jsx)(a.A,{variant:"contained",onClick:()=>{me(!1),ye("/admin/orders/".concat(be.id))},sx:{background:"#8B7355",color:"white","&:hover":{background:"#755F47"}},children:"View Full Details"})]})]})}),(0,$.jsx)(E.A,{open:Ce.open,autoHideDuration:6e3,onClose:()=>_e((0,i.A)((0,i.A)({},Ce),{},{open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,$.jsx)(L.A,{onClose:()=>_e((0,i.A)((0,i.A)({},Ce),{},{open:!1})),severity:Ce.severity,sx:{background:"white",color:"#4A4A3A",boxShadow:"0 8px 24px rgba(0,0,0,0.1)",borderRadius:2,border:"1px solid rgba(139, 115, 85, 0.2)"},children:Ce.message})})]})})}const X={textField:{"& .MuiOutlinedInput-root":{borderRadius:"12px",background:"white","& fieldset":{borderColor:"rgba(139, 115, 85, 0.2)"},"&:hover fieldset":{borderColor:"rgba(139, 115, 85, 0.4)"},"&.Mui-focused fieldset":{borderColor:"#8B7355",borderWidth:"2px"}}},select:{"& .MuiOutlinedInput-root":{borderRadius:"12px",background:"white"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(139, 115, 85, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(139, 115, 85, 0.4)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#8B7355",borderWidth:"2px"}}}}}]);
//# sourceMappingURL=869.b3e9077c.chunk.js.map